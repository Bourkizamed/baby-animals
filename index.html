<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Baby Animal World</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root { --bg-color: #f0fdf4; --card-color: #ffffff; --text-color: #333; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
            height: 100vh;
            overflow: hidden;
        }
        .title {
            margin: 20px 0 10px 0;
            font-size: 1.8rem;
            color: #2d3748;
            text-align: center;
            padding: 0 20px;
        }
        .subtitle {
            color: #4a5568;
            margin-bottom: 20px;
            text-align: center;
            padding: 0 20px;
        }
        .grid-container {
            width: 100%;
            flex: 1;
            overflow-y: auto;
            padding: 0 20px 20px 20px;
            box-sizing: border-box;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            max-width: 500px;
            margin: 0 auto;
            padding-bottom: 30px;
        }
        .animal-card {
            background: var(--card-color);
            border-radius: 25px;
            padding: 30px 10px;
            text-align: center;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            -webkit-tap-highlight-color: transparent;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .animal-card:hover {
            box-shadow: 0 12px 20px rgba(0,0,0,0.15);
        }
        .animal-card:active { 
            transform: scale(0.95); 
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .emoji { 
            font-size: 5rem; 
            display: block; 
            margin-bottom: 10px; 
            transition: transform 0.3s;
        }
        .animal-card:active .emoji {
            transform: scale(1.1);
        }
        .name { 
            font-size: 1.5rem; 
            font-weight: bold; 
            color: var(--text-color);
            margin-bottom: 5px;
        }
        .lang-hint {
            font-size: 0.9rem;
            color: #4ade80;
            font-weight: 500;
            opacity: 0.9;
        }
        .scroll-indicator {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: #718096;
            animation: bounce 2s infinite;
            pointer-events: none;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateX(-50%) translateY(0);}
            40% {transform: translateX(-50%) translateY(-10px);}
            60% {transform: translateX(-50%) translateY(-5px);}
        }
        /* Custom scrollbar */
        .grid-container::-webkit-scrollbar {
            width: 8px;
        }
        .grid-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        .grid-container::-webkit-scrollbar-thumb {
            background: #c6f6d5;
            border-radius: 4px;
        }
        .grid-container::-webkit-scrollbar-thumb:hover {
            background: #9ae6b4;
        }
    </style>
</head>
<body>

<div class="grid-container">
    <div class="grid" id="animalGrid"></div>
</div>

<div class="scroll-indicator">Scroll for more animals â†“</div>

<script>
    // Speech Manager to handle speech synthesis with interruption
    const SpeechManager = {
        currentUtterance: null,
        isSpeaking: false,
        
        speak(text, langCode) {
            // Cancel any ongoing speech immediately
            this.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = langCode;
            utterance.rate = 0.8;
            
            this.currentUtterance = utterance;
            
            utterance.onend = () => {
                this.currentUtterance = null;
                this.isSpeaking = false;
            };
            
            utterance.onerror = () => {
                this.currentUtterance = null;
                this.isSpeaking = false;
            };
            
            this.isSpeaking = true;
            window.speechSynthesis.speak(utterance);
        },
        
        cancel() {
            if (window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
                this.currentUtterance = null;
                this.isSpeaking = false;
            }
        }
    };

    const languages = [
        { code: 'en-US', name: 'English' },
        { code: 'fr-FR', name: 'FranÃ§ais' },
        { code: 'ar-SA', name: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' }
    ];
    
    const animals = [
        // Original animals
        { en: "Lion", fr: "Lion", ar: "Ø£Ø³Ø¯", emoji: "ðŸ¦" },
        { en: "Cat", fr: "Chat", ar: "Ù‚Ø·Ø©", emoji: "ðŸ±" },
        { en: "Dog", fr: "Chien", ar: "ÙƒÙ„Ø¨", emoji: "ðŸ¶" },
        { en: "Cow", fr: "Vache", ar: "Ø¨Ù‚Ø±Ø©", emoji: "ðŸ®" },
        { en: "Elephant", fr: "Ã‰lÃ©phant", ar: "ÙÙŠÙ„", emoji: "ðŸ˜" },
        { en: "Bird", fr: "Oiseau", ar: "Ø¹ØµÙÙˆØ±", emoji: "ðŸ¦" },
        
        // Additional animals - Farm & Domestic
        { en: "Horse", fr: "Cheval", ar: "Ø­ØµØ§Ù†", emoji: "ðŸ´" },
        { en: "Pig", fr: "Cochon", ar: "Ø®Ù†Ø²ÙŠØ±", emoji: "ðŸ·" },
        { en: "Sheep", fr: "Mouton", ar: "Ø®Ø±ÙˆÙ", emoji: "ðŸ‘" },
        { en: "Goat", fr: "ChÃ¨vre", ar: "Ù…Ø§Ø¹Ø²", emoji: "ðŸ" },
        { en: "Rabbit", fr: "Lapin", ar: "Ø£Ø±Ù†Ø¨", emoji: "ðŸ°" },
        { en: "Chicken", fr: "Poulet", ar: "Ø¯Ø¬Ø§Ø¬Ø©", emoji: "ðŸ”" },
        { en: "Duck", fr: "Canard", ar: "Ø¨Ø·Ø©", emoji: "ðŸ¦†" },
        
        // Wild animals
        { en: "Tiger", fr: "Tigre", ar: "Ù†Ù…Ø±", emoji: "ðŸ¯" },
        { en: "Bear", fr: "Ours", ar: "Ø¯Ø¨", emoji: "ðŸ»" },
        { en: "Monkey", fr: "Singe", ar: "Ù‚Ø±Ø¯", emoji: "ðŸµ" },
        { en: "Panda", fr: "Panda", ar: "Ø¨Ø§Ù†Ø¯Ø§", emoji: "ðŸ¼" },
        { en: "Koala", fr: "Koala", ar: "ÙƒÙˆØ§Ù„Ø§", emoji: "ðŸ¨" },
        { en: "Penguin", fr: "Pingouin", ar: "Ø¨Ø·Ø±ÙŠÙ‚", emoji: "ðŸ§" },
        { en: "Owl", fr: "Hibou", ar: "Ø¨ÙˆÙ…Ø©", emoji: "ðŸ¦‰" },
        
        // Sea animals
        { en: "Fish", fr: "Poisson", ar: "Ø³Ù…ÙƒØ©", emoji: "ðŸŸ" },
        { en: "Dolphin", fr: "Dauphin", ar: "Ø¯Ù„ÙÙŠÙ†", emoji: "ðŸ¬" },
        { en: "Whale", fr: "Baleine", ar: "Ø­ÙˆØª", emoji: "ðŸ‹" },
        { en: "Octopus", fr: "Poulpe", ar: "Ø£Ø®Ø·Ø¨ÙˆØ·", emoji: "ðŸ™" },
        { en: "Shark", fr: "Requin", ar: "Ù‚Ø±Ø´", emoji: "ðŸ¦ˆ" },
        { en: "Turtle", fr: "Tortue", ar: "Ø³Ù„Ø­ÙØ§Ø©", emoji: "ðŸ¢" },
        { en: "Frog", fr: "Grenouille", ar: "Ø¶ÙØ¯Ø¹", emoji: "ðŸ¸" },
        
        // More animals
        { en: "Butterfly", fr: "Papillon", ar: "ÙØ±Ø§Ø´Ø©", emoji: "ðŸ¦‹" },
        { en: "Bee", fr: "Abeille", ar: "Ù†Ø­Ù„Ø©", emoji: "ðŸ" },
        { en: "Snail", fr: "Escargot", ar: "Ø­Ù„Ø²ÙˆÙ†", emoji: "ðŸŒ" },
        { en: "Ladybug", fr: "Coccinelle", ar: "Ø®Ù†ÙØ³Ø§Ø¡", emoji: "ðŸž" },
        { en: "Giraffe", fr: "Girafe", ar: "Ø²Ø±Ø§ÙØ©", emoji: "ðŸ¦’" },
        { en: "Zebra", fr: "ZÃ¨bre", ar: "Ø­Ù…Ø§Ø± ÙˆØ­Ø´ÙŠ", emoji: "ðŸ¦“" },
        { en: "Hippo", fr: "Hippopotame", ar: "ÙØ±Ø³ Ø§Ù„Ù†Ù‡Ø±", emoji: "ðŸ¦›" },
        { en: "Crocodile", fr: "Crocodile", ar: "ØªÙ…Ø³Ø§Ø­", emoji: "ðŸŠ" },
        { en: "Kangaroo", fr: "Kangourou", ar: "ÙƒÙ†ØºØ±", emoji: "ðŸ¦˜" },
        { en: "Fox", fr: "Renard", ar: "Ø«Ø¹Ù„Ø¨", emoji: "ðŸ¦Š" },
        { en: "Raccoon", fr: "Raton laveur", ar: "Ø±Ø§ÙƒÙˆÙ†", emoji: "ðŸ¦" },
        { en: "Llama", fr: "Lama", ar: "Ù„Ø§Ù…Ø§", emoji: "ðŸ¦™" },
        { en: "Peacock", fr: "Paon", ar: "Ø·Ø§ÙˆÙˆØ³", emoji: "ðŸ¦š" },
        { en: "Swan", fr: "Cygne", ar: "Ø¨Ø¬Ø¹Ø©", emoji: "ðŸ¦¢" },
        { en: "Parrot", fr: "Perroquet", ar: "Ø¨Ø¨ØºØ§Ø¡", emoji: "ðŸ¦œ" },
        { en: "Bat", fr: "Chauve-souris", ar: "Ø®ÙØ§Ø´", emoji: "ðŸ¦‡" },
        { en: "Hedgehog", fr: "HÃ©risson", ar: "Ù‚Ù†ÙØ°", emoji: "ðŸ¦”" },
        { en: "Dinosaur", fr: "Dinosaure", ar: "Ø¯ÙŠÙ†Ø§ØµÙˆØ±", emoji: "ðŸ¦–" },
        { en: "Dragon", fr: "Dragon", ar: "ØªÙ†ÙŠÙ†", emoji: "ðŸ‰" },
        { en: "Unicorn", fr: "Licorne", ar: "Ø­ØµØ§Ù† ÙˆØ­ÙŠØ¯ Ø§Ù„Ù‚Ø±Ù†", emoji: "ðŸ¦„" }
    ];

    // Store current language for each animal
    let animalLanguages = new Map();

    function getRandomLanguage() {
        return languages[Math.floor(Math.random() * languages.length)];
    }

    function speak(text, langCode) {
        SpeechManager.speak(text, langCode);
    }

    function getAnimalName(animal, langCode) {
        switch(langCode) {
            case 'fr-FR': return animal.fr;
            case 'ar-SA': return animal.ar;
            default: return animal.en;
        }
    }

    function getLangName(langCode) {
        const lang = languages.find(l => l.code === langCode);
        return lang ? lang.name : 'English';
    }

    function updateCardDisplay(card, animal) {
        const currentLang = animalLanguages.get(animal.en) || 'en-US';
        const name = getAnimalName(animal, currentLang);
        const langName = getLangName(currentLang);
        
        const nameSpan = card.querySelector('.name');
        const hintSpan = card.querySelector('.lang-hint');
        
        nameSpan.textContent = name;
        hintSpan.textContent = `(${langName})`;
    }

    function render() {
        const grid = document.getElementById('animalGrid');
        grid.innerHTML = '';
        
        animals.forEach(animal => {
            const card = document.createElement('div');
            card.className = 'animal-card';
            
            // Initialize with default language (English) if not set
            const currentLang = animalLanguages.get(animal.en) || 'en-US';
            const currentName = getAnimalName(animal, currentLang);
            const langName = getLangName(currentLang);
            
            card.innerHTML = `
                <span class="emoji">${animal.emoji}</span>
                <span class="name">${currentName}</span>
                <div class="lang-hint">(${langName})</div>
            `;
            
            card.onclick = () => {
                // Get a new random language
                const newLang = getRandomLanguage();
                
                // Store the new language for this animal
                animalLanguages.set(animal.en, newLang.code);
                
                // Update the display
                updateCardDisplay(card, animal);
                
                // Speak the name (SpeechManager will cancel any ongoing speech)
                const name = getAnimalName(animal, newLang.code);
                speak(name, newLang.code);
            };
            
            grid.appendChild(card);
        });
    }

    // Initialize
    render();
    
    // Hide scroll indicator after 5 seconds
    setTimeout(() => {
        const indicator = document.querySelector('.scroll-indicator');
        if (indicator) {
            indicator.style.opacity = '0';
            indicator.style.transition = 'opacity 1s';
            setTimeout(() => indicator.style.display = 'none', 1000);
        }
    }, 5000);
    
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js');
    }
</script>
</body>
</html>